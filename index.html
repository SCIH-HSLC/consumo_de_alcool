<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Produtos Hospitalares - Natal</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
background: linear-gradient(135deg, #1a472a 0%, #0d2818 50%, #1a472a 100%);
color: #f0f0f0;
min-height: 100vh;
padding: 20px;
position: relative;
overflow-x: hidden;
}

/* Elementos decorativos natalinos */
.snowflake {
position: absolute;
color: white;
font-size: 1em;
top: -20px;
animation: fall linear infinite;
z-index: 1;
}

@keyframes fall {
to {
transform: translateY(100vh);
}
}

.garland {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 40px;
background: linear-gradient(90deg, 
    transparent 0%, 
    #ff0000 10%, 
    #32cd32 20%, 
    #ffffff 30%, 
    #ff0000 40%, 
    #32cd32 50%, 
    #ffffff 60%, 
    #ff0000 70%, 
    #32cd32 80%, 
    #ffffff 90%, 
    transparent 100%);
z-index: 2;
clip-path: polygon(0% 0%, 100% 0%, 95% 100%, 5% 100%);
}

.container {
max-width: 900px;
margin: 0 auto;
position: relative;
z-index: 10;
}

header {
background: linear-gradient(to right, #0d2818, #1a472a);
border-radius: 10px;
padding: 20px;
margin-bottom: 30px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
display: flex;
justify-content: space-between;
align-items: center;
position: relative;
border: 2px solid #c62828;
}

.logo {
display: flex;
align-items: center;
gap: 15px;
}

.logo-icon {
background: #c62828;
width: 60px;
height: 60px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
border: 2px solid #ffd700;
box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.logo-icon i {
font-size: 28px;
color: white;
}

.logo-text h1 {
color: #ffd700;
font-size: 28px;
margin-bottom: 5px;
text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.logo-text p {
color: #ffffff;
font-size: 14px;
}

.info-box {
background: rgba(13, 40, 24, 0.8);
border-left: 4px solid #c62828;
padding: 15px;
margin: 20px 0;
border-radius: 0 5px 5px 0;
font-size: 16px;
border: 1px solid #ffd700;
box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

.info-box h2 {
color: #ffd700;
font-size: 20px;
margin-bottom: 8px;
}

.main-content {
display: grid;
grid-template-columns: 1fr;
gap: 30px;
}

.card {
background: linear-gradient(to bottom right, rgba(26, 71, 42, 0.95), rgba(13, 40, 24, 0.95));
border-radius: 10px;
padding: 25px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
border: 2px solid #c62828;
position: relative;
overflow: hidden;
}

.card::before {
content: "üéÑ";
position: absolute;
top: 10px;
right: 10px;
font-size: 24px;
opacity: 0.3;
}

.card-title {
color: #ffd700;
margin-bottom: 25px;
display: flex;
align-items: center;
gap: 10px;
border-bottom: 2px solid #c62828;
padding-bottom: 15px;
text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
}

.card-title i {
font-size: 24px;
}

.form-group {
margin-bottom: 20px;
}

label {
display: block;
margin-bottom: 8px;
font-weight: 600;
color: #ffd700;
display: flex;
align-items: center;
gap: 8px;
}

.hospital-icon {
color: #c62828;
}

select, input {
width: 100%;
padding: 12px 15px;
background-color: rgba(255, 255, 255, 0.95);
border: 2px solid #1a472a;
border-radius: 8px;
font-size: 16px;
transition: all 0.3s;
color: #0d2818;
}

select:focus, input:focus {
border-color: #ffd700;
outline: none;
box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.3);
}

button {
background: linear-gradient(to right, #c62828, #ff6f61);
color: white;
border: none;
padding: 14px 25px;
font-size: 16px;
border-radius: 8px;
cursor: pointer;
transition: all 0.3s;
font-weight: 600;
display: flex;
align-items: center;
gap: 10px;
border: 1px solid #ffd700;
box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

button:hover {
transform: translateY(-2px);
box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
background: linear-gradient(to right, #ff6f61, #c62828);
}

.btn-container {
display: flex;
gap: 15px;
margin-top: 10px;
flex-wrap: wrap;
}

.btn-clear {
background: linear-gradient(to right, #1a472a, #0d2818);
}

.btn-export {
background: linear-gradient(to right, #0d2818, #1a472a);
}

.btn-edit {
background: linear-gradient(to right, #ff8c00, #ffa500);
}

.btn-cancel {
background: linear-gradient(to right, #666666, #888888);
}

footer {
text-align: center;
color: #ffd700;
margin-top: 30px;
padding: 20px;
font-size: 14px;
background: rgba(13, 40, 24, 0.8);
border-radius: 10px;
border: 1px solid #c62828;
}

footer i {
color: #c62828;
margin: 0 5px;
}

.notification {
position: fixed;
top: 20px;
right: 20px;
background: linear-gradient(to right, #1a472a, #0d2818);
color: white;
padding: 15px 25px;
border-radius: 8px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
transform: translateX(200%);
transition: transform 0.3s ease-in-out;
display: flex;
align-items: center;
gap: 10px;
z-index: 1000;
border: 1px solid #ffd700;
}

.notification.show {
transform: translateX(0);
}

.notification.error {
background: linear-gradient(to right, #8B0000, #c62828);
}

.notification.warning {
background: linear-gradient(to right, #FF8C00, #FFA500);
}

.export-btn-container {
display: flex;
justify-content: flex-end;
margin-top: 15px;
gap: 10px;
}

.stats-container {
display: flex;
justify-content: space-around;
margin-top: 20px;
flex-wrap: wrap;
gap: 15px;
}

.stat-card {
background: linear-gradient(to right, #c62828, #ff6f61);
color: white;
padding: 15px;
border-radius: 8px;
text-align: center;
min-width: 150px;
border: 1px solid #ffd700;
box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

.stat-value {
font-size: 24px;
font-weight: bold;
margin-top: 10px;
}

.stat-label {
font-size: 14px;
}

.confirmation-modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.8);
display: flex;
align-items: center;
justify-content: center;
z-index: 2000;
opacity: 0;
visibility: hidden;
transition: all 0.3s;
}

.confirmation-modal.show {
opacity: 1;
visibility: visible;
}

.modal-content {
background: linear-gradient(to bottom right, #0d2818, #1a472a);
border-radius: 10px;
padding: 30px;
max-width: 500px;
width: 90%;
text-align: center;
border: 2px solid #c62828;
color: #f0f0f0;
}

.modal-buttons {
display: flex;
justify-content: center;
gap: 15px;
margin-top: 25px;
}

.status-indicator {
position: absolute;
top: 20px;
right: 20px;
display: flex;
align-items: center;
gap: 8px;
background: rgba(255, 255, 255, 0.1);
padding: 8px 15px;
border-radius: 20px;
font-size: 14px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
border: 1px solid #ffd700;
}

.status-dot {
width: 12px;
height: 12px;
border-radius: 50%;
background-color: #32cd32;
}

.status-dot.offline {
background-color: #c62828;
}

.spinner {
border: 3px solid rgba(255, 255, 255, 0.3);
border-radius: 50%;
border-top: 3px solid #ffd700;
width: 20px;
height: 20px;
animation: spin 1s linear infinite;
display: none;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

/* Estrelas no fundo */
.star {
position: absolute;
background-color: white;
border-radius: 50%;
z-index: 1;
}

.star.small {
width: 2px;
height: 2px;
}

.star.medium {
width: 3px;
height: 3px;
}

.star.large {
width: 4px;
height: 4px;
}

/* √Årvore de natal decorativa */
.christmas-tree {
position: absolute;
bottom: 0;
right: 0;
width: 100px;
height: 150px;
z-index: 5;
opacity: 0.7;
pointer-events: none;
}

/* Responsive Design */
@media (max-width: 768px) {
.btn-container {
flex-direction: column;
}

button {
width: 100%;
justify-content: center;
}

.stats-container {
flex-direction: column;
align-items: center;
}

.status-indicator {
position: relative;
top: auto;
right: auto;
margin-top: 10px;
justify-content: center;
width: 100%;
}

header {
flex-direction: column;
text-align: center;
gap: 15px;
}
}
</style>
</head>
<body>

<!-- Decora√ß√£o natalina -->
<div class="garland"></div>
<div class="christmas-tree">
<pre style="color: #32cd32; font-size: 20px; text-align: center;">
   *
  ***
 *****
*******
   |
</pre>
</div>

<div class="container">
<header>
<div class="logo">
<div class="logo-icon">
<i class="fas fa-hospital-alt"></i>
</div>
<div class="logo-text">
<h1><i class="fas fa-candy-cane"></i> Controle de Produtos Hospitalares <i class="fas fa-candy-cane"></i></h1>
<p>Sistema de gest√£o de insumos e produtos de higiene - Feliz Natal!</p>
</div>
</div>
<div class="status-indicator" id="status-indicator">
<div class="status-dot" id="status-dot"></div>
<span id="status-text">Online</span>
<div class="spinner" id="spinner"></div>
</div>
</header>

<div class="info-box">
<p>
üéÑ <strong>Feliz Natal!</strong> üéÑ<br>
Ao clicar no bot√£o <strong>Salvar Registro</strong>, os dados ser√£o automaticamente 
enviados para uma planilha espec√≠fica, organizada por setor. Essa planilha cont√©m todos os 
registros salvos, facilitando o controle e a an√°lise dos insumos utilizados.
</p>
</div>

<div class="main-content">
<div class="card">
<h2 class="card-title"><i class="fas fa-calculator"></i> Controle de Produtos - Natalino</h2>
<form id="hygieneForm" class="form-card">
<div class="form-group">
<label for="product"><i class="fas fa-pump-soap hospital-icon"></i> Produto:</label>
<select id="product" name="product" required>
<option value="">Selecione um produto</option>
<option value="SABONETE L√çQUIDO (500 ml)">SABONETE L√çQUIDO (500 ml)</option>
<option value="SABONETE L√çQUIDO (200 ml)">SABONETE L√çQUIDO (200 ml)</option>  
<option value="SABONETE LIQUIDO CLOREX (1000ML)">SABONETE LIQUIDO CLOREX (1000ML)</option>
<option value="√ÅLCOOL EM GEL (700 ml)">√ÅLCOOL EM GEL (700 ml)</option>
<option value="√ÅLCOOL PUMP (250 ml)">√ÅLCOOL PUMP (250 ml)</option>
<option value="√ÅLCOOL ESPUMA (1000 ml)">√ÅLCOOL ESPUMA (1000 ml)</option>
<option value="√ÅLCOOL PURELL (1200 ml)">√ÅLCOOL PURELL (1200 ml)</option>
<option value="√ÅLCOOL ESPUMA (475 ml)">√ÅLCOOL ESPUMA PUMP (475 ml)</option>
</select>
</div>

<div class="form-group">
<label for="sector"><i class="fas fa-building hospital-icon"></i> Setor:</label>
<select id="sector" name="sector" required>
<option value="">Selecione um setor</option>
<option value="7¬∫ ANDAR - INTERNA√á√ÉO">7¬∫ ANDAR - INTERNA√á√ÉO</option>
<option value="6¬∫ ANDAR - INTERNA√á√ÉO">6¬∫ ANDAR - INTERNA√á√ÉO</option>
<option value="6¬∫ ANDAR - MATERNIDADE">6¬∫ ANDAR - MATERNIDADE</option>
<option value="5¬∫ ANDAR - INTERNA√á√ÉO">5¬∫ ANDAR - INTERNA√á√ÉO</option>
<option value="5¬∫ ANDAR - ONCOLOGIA">5¬∫ ANDAR - ONCOLOGIA</option>
<option value="4¬∫ ANDAR - CEMED">4¬∫ ANDAR - CEMED</option>
<option value="3¬∫ ANDAR - PEDIATRIA INTERNA√á√ÉO">3¬∫ ANDAR - PEDIATRIA INTERNA√á√ÉO</option>
<option value="3¬∫ ANDAR - UTI PEDIATRICA">3¬∫ ANDAR - UTI PEDIATRICA</option>
<option value="3¬∫ ANDAR - UTI NEONATAL">3¬∫ ANDAR - UTI NEONATAL</option>
<option value="2¬∫ ANDAR CENTRO CIRURGICO">2¬∫ ANDAR CENTRO CIRURGICO</option>
<option value="2¬∫ ANDAR CENTRO OBST√âTRICO">2¬∫ ANDAR CENTRO OBST√âTRICO</option>
<option value="2¬∫ ANDAR - HOSPITAL DIA">2¬∫ ANDAR - HOSPITAL DIA</option>
<option value="1¬∫ ANDAR ADULTO DML 01 ‚Äì UTI">1¬∫ ANDAR ADULTO DML 01 ‚Äì UTI</option>
<option value="T√âRREO DML SADT">T√âRREO DML SADT</option>
<option value="T√âRREO DML PSA">T√âRREO DML PSA</option>
<option value="T√âRREO DML PSI">T√âRREO DML PSI</option>
<option value="S1 DML 1 - MEDICINA DO TRABALHO">S1 DML 1 - MEDICINA DO TRABALHO</option>
<option value="S1 DML 2 - MANUTEN√á√ÉO">S1 DML 2 - MANUTEN√á√ÉO</option>
</select>
</div>

<div class="form-group">
<label for="quantity"><i class="fas fa-boxes hospital-icon"></i> Quantidade:</label>
<input type="number" id="quantity" name="quantity" min="1" value="1" placeholder="Quantidade" required>
</div>

<div class="form-group">
<label for="date"><i class="fas fa-calendar-alt hospital-icon"></i> Data:</label>
<input type="date" id="date" name="date" required>
</div>

<div class="form-group">
<label for="registro-status"><i class="fas fa-info-circle hospital-icon"></i> Status do Registro:</label>
<input type="text" id="registro-status" name="registro-status" value="Registrado" readonly style="background-color: rgba(255, 255, 255, 0.9); font-weight: bold; color: #32cd32;">
</div>

<div class="btn-container">
<button id="save-btn" type="submit"><i class="fas fa-save"></i> Salvar Registro</button>
<button id="update-btn" class="btn-edit" style="display:none;"><i class="fas fa-edit"></i> Atualizar</button>
<button id="clear-btn" class="btn-clear" type="button"><i class="fas fa-trash-alt"></i> Limpar</button>
<button id="cancel-edit-btn" class="btn-cancel" style="display:none;"><i class="fas fa-times"></i> Cancelar</button>
<button id="export-btn" class="btn-export"><i class="fas fa-file-excel"></i> Exportar para Excel</button>
</div>

<div class="stats-container">
<div class="stat-card">
<div class="stat-label">Total de Registros</div>
<div class="stat-value" id="total-records">0</div>
</div>
<div class="stat-card">
<div class="stat-label">Produtos Hoje</div>
<div class="stat-value" id="today-records">0</div>
</div>
<div class="stat-card">
<div class="stat-label">Enviados</div>
<div class="stat-value" id="sent-records">0</div>
</div>
</div>
</form>
</div>
</div>

<footer>
<p><i class="fas fa-tree"></i> Sistema de Controle de Produtos Hospitalares &copy; 2025 - Desenvolvido para o Hospital S√£o Luiz Campinas <i class="fas fa-tree"></i></p>
<p style="margin-top: 10px; color: #ffd700;"><i class="fas fa-star"></i> Desejamos a todos um Feliz Natal e um Pr√≥spero Ano Novo! <i class="fas fa-star"></i></p>
</footer>
</div>

<div class="notification" id="notification">
<i class="fas fa-check-circle"></i>
<span>Registro salvo com sucesso!</span>
</div>

<div class="confirmation-modal" id="confirmation-modal">
<div class="modal-content">
<i class="fas fa-exclamation-triangle" style="font-size: 48px; color: #ffd700; margin-bottom: 20px;"></i>
<h3 style="margin-bottom: 15px;">Confirmar Exclus√£o</h3>
<p>Voc√™ tem certeza que deseja excluir este registro?</p>
<p style="font-weight: 600; margin: 15px 0;" id="item-to-delete"></p>
<p>Esta a√ß√£o n√£o pode ser desfeita.</p>
<div class="modal-buttons">
<button id="confirm-delete-btn" class="btn-clear"><i class="fas fa-trash-alt"></i> Excluir</button>
<button id="cancel-delete-btn" class="btn-cancel"><i class="fas fa-times"></i> Cancelar</button>
</div>
</div>
</div>

<script>
// Elementos do DOM
const saveBtn = document.getElementById('save-btn');
const updateBtn = document.getElementById('update-btn');
const clearBtn = document.getElementById('clear-btn');
const cancelEditBtn = document.getElementById('cancel-edit-btn');
const exportBtn = document.getElementById('export-btn');
const productSelect = document.getElementById('product');
const sectorSelect = document.getElementById('sector');
const quantityInput = document.getElementById('quantity');
const dateInput = document.getElementById('date');
const notification = document.getElementById('notification');
const totalRecordsElement = document.getElementById('total-records');
const todayRecordsElement = document.getElementById('today-records');
const sentRecordsElement = document.getElementById('sent-records');
const confirmationModal = document.getElementById('confirmation-modal');
const itemToDelete = document.getElementById('item-to-delete');
const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
const statusIndicator = document.getElementById('status-indicator');
const statusDot = document.getElementById('status-dot');
const statusText = document.getElementById('status-text');
const spinner = document.getElementById('spinner');
const form = document.getElementById('hygieneForm');
const statusField = document.getElementById("registro-status");

// Vari√°veis de estado
let currentEditId = null;
let itemToDeleteId = null;
let isOnline = true;
let sentRecords = 0;

// Fun√ß√£o para obter data atual formatada
function getTodayDate() {
const today = new Date();
return today.toISOString().split('T')[0];
}

// Fun√ß√£o para formatar data para exibi√ß√£o
function formatDateForDisplay(dateStr) {
const date = new Date(dateStr);
return date.toLocaleDateString('pt-BR', {
day: '2-digit',
month: '2-digit',
year: 'numeric'
});
}

// Inicializar data no formul√°rio
function initializeFormDate() {
dateInput.value = getTodayDate();
}

// Verificar status da conex√£o
function checkOnlineStatus() {
isOnline = navigator.onLine;
updateStatusIndicator();
}

// Atualizar indicador de status
function updateStatusIndicator() {
if (isOnline) {
statusDot.classList.remove('offline');
statusText.textContent = 'Online';
statusIndicator.style.background = 'rgba(50, 205, 50, 0.2)';
} else {
statusDot.classList.add('offline');
statusText.textContent = 'Offline';
statusIndicator.style.background = 'rgba(198, 40, 40, 0.2)';
}
}

// Carregar hist√≥rico do localStorage
function loadStatistics() {
const history = JSON.parse(localStorage.getItem('productHistory')) || [];
updateStatistics(history);
}

// Atualizar estat√≠sticas
function updateStatistics(history) {
totalRecordsElement.textContent = history.length;
sentRecordsElement.textContent = sentRecords;

// Contar registros de hoje
const todayDate = getTodayDate();
const todayRecords = history.filter(item => {
return item.date === todayDate;
}).length;

todayRecordsElement.textContent = todayRecords;
}

// Mostrar notifica√ß√£o
function showNotification(message, type = 'success') {
notification.querySelector('span').textContent = message;
notification.className = 'notification';

if (type === 'error') {
notification.classList.add('error');
} else if (type === 'warning') {
notification.classList.add('warning');
}

notification.classList.add('show');

setTimeout(() => {
notification.classList.remove('show');
}, 3000);
}

// Salvar registro
function saveRecord(e) {
e.preventDefault();

const product = productSelect.value;
const sector = sectorSelect.value;
const quantity = quantityInput.value;
const date = dateInput.value;
const status = statusField.value;

if (!product || !sector || !quantity || !date) {
showNotification('Por favor, preencha todos os campos!', 'error');
return;
}

const record = {
product,
sector,
quantity,
date,
"registro-status": status,
id: Date.now(),
sent: false
};

// Obter hist√≥rico atual ou criar novo array
const history = JSON.parse(localStorage.getItem('productHistory')) || [];

// Adicionar novo registro
history.push(record);

// Salvar no localStorage
localStorage.setItem('productHistory', JSON.stringify(history));

// Atualizar estat√≠sticas
updateStatistics(history);

// Enviar para SheetMonkey se estiver online
if (isOnline) {
sendToSheetMonkey(record);
} else {
showNotification('Registro salvo localmente (offline). Ser√° enviado quando a conex√£o for restaurada.', 'warning');
}

// Limpar campos
clearFields();

// Mostrar notifica√ß√£o
showNotification('Registro salvo com sucesso!');
}

// Enviar dados para SheetMonkey
async function sendToSheetMonkey(record) {
spinner.style.display = 'inline-block';

try {
const response = await fetch('https://api.sheetmonkey.io/form/9qTdVSMErCaMi6T6avZJKm', {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({
product: record.product,
sector: record.sector,
quantity: record.quantity,
date: record.date,
"registro-status": record["registro-status"]
})
});

if (response.ok) {
const history = JSON.parse(localStorage.getItem('productHistory')) || [];
const recordIndex = history.findIndex(item => item.id === record.id);

if (recordIndex !== -1) {
history[recordIndex].sent = true;
localStorage.setItem('productHistory', JSON.stringify(history));
sentRecords++;
sentRecordsElement.textContent = sentRecords;
}
} else {
throw new Error('Falha no envio');
}
} catch (error) {
console.error('Erro ao enviar para SheetMonkey:', error);
showNotification('Erro ao enviar para a planilha. Os dados ser√£o enviados quando a conex√£o for restaurada.', 'error');
} finally {
spinner.style.display = 'none';
}
}

// Verificar e enviar registros pendentes
function sendPendingRecords() {
const history = JSON.parse(localStorage.getItem('productHistory')) || [];
const pendingRecords = history.filter(record => !record.sent);

if (pendingRecords.length > 0 && isOnline) {
showNotification(`Enviando ${pendingRecords.length} registro(s) pendente(s)...`, 'warning');

pendingRecords.forEach(record => {
sendToSheetMonkey(record);
});
}
}

// Limpar campos
function clearFields() {
productSelect.value = '';
sectorSelect.value = '';
quantityInput.value = '1';
dateInput.value = getTodayDate();
statusField.value = "Registrado";
statusField.style.color = "#32cd32";
currentEditId = null;
saveBtn.style.display = 'flex';
updateBtn.style.display = 'none';
cancelEditBtn.style.display = 'none';
}

// Exportar para Excel
function exportToExcel() {
const history = JSON.parse(localStorage.getItem('productHistory')) || [];

if (history.length === 0) {
showNotification('Nenhum dado para exportar!', 'error');
return;
}

// Preparar dados para a planilha
const data = [
['Produto', 'Setor', 'Quantidade', 'Data', 'Status', 'Enviado']
];

history.forEach(item => {
data.push([
item.product,
item.sector,
item.quantity,
item.date,
item["registro-status"],
item.sent ? 'Sim' : 'N√£o'
]);
});

// Criar uma planilha
const ws = XLSX.utils.aoa_to_sheet(data);

// Estilizar cabe√ßalho
if (!ws['A1'].s) ws['A1'].s = {};
if (!ws['B1'].s) ws['B1'].s = {};
if (!ws['C1'].s) ws['C1'].s = {};
if (!ws['D1'].s) ws['D1'].s = {};
if (!ws['E1'].s) ws['E1'].s = {};
if (!ws['F1'].s) ws['F1'].s = {};

ws['A1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};
ws['B1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};
ws['C1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};
ws['D1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};
ws['E1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};
ws['F1'].s = {font: {bold: true}, fill: {fgColor: {rgb: "FFD700"}}};

// Criar um workbook
const wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, 'Controle de Produtos');

// Exportar o arquivo
const fileName = `controle_produtos_natal_${new Date().toISOString().slice(0, 10)}.xlsx`;
XLSX.writeFile(wb, fileName);

showNotification('Dados exportados com sucesso!');
}

// Criar decora√ß√µes natalinas
function createChristmasDecorations() {
// Criar estrelas
for (let i = 0; i < 50; i++) {
const star = document.createElement('div');
star.classList.add('star');
const size = Math.random() * 3 + 1;
star.style.width = `${size}px`;
star.style.height = `${size}px`;
star.style.left = `${Math.random() * 100}vw`;
star.style.top = `${Math.random() * 100}vh`;
star.style.opacity = Math.random() * 0.5 + 0.2;
document.body.appendChild(star);
}

// Criar flocos de neve
for (let i = 0; i < 30; i++) {
const snowflake = document.createElement('div');
snowflake.classList.add('snowflake');
snowflake.innerHTML = '‚ùÑ';
snowflake.style.left = `${Math.random() * 100}vw`;
snowflake.style.fontSize = `${Math.random() * 10 + 10}px`;
snowflake.style.opacity = Math.random() * 0.5 + 0.3;
snowflake.style.animationDuration = `${Math.random() * 10 + 10}s`;
snowflake.style.animationDelay = `${Math.random() * 5}s`;
document.body.appendChild(snowflake);
}
}

// Event Listeners
form.addEventListener('submit', saveRecord);
clearBtn.addEventListener('click', () => {
clearFields();
showNotification('Campos limpos!');
});
exportBtn.addEventListener('click', exportToExcel);
confirmDeleteBtn.addEventListener('click', () => {
confirmationModal.classList.remove('show');
});
cancelDeleteBtn.addEventListener('click', () => {
confirmationModal.classList.remove('show');
});

// Verificar conex√£o ao carregar e durante mudan√ßas
window.addEventListener('load', () => {
checkOnlineStatus();
initializeFormDate();
createChristmasDecorations();

// Contar registros enviados
const history = JSON.parse(localStorage.getItem('productHistory')) || [];
sentRecords = history.filter(item => item.sent).length;
loadStatistics();
});

window.addEventListener('online', () => {
isOnline = true;
updateStatusIndicator();
showNotification('Conex√£o restaurada. Enviando registros pendentes...', 'warning');
sendPendingRecords();
});

window.addEventListener('offline', () => {
isOnline = false;
updateStatusIndicator();
showNotification('Voc√™ est√° offline. Os registros ser√£o salvos localmente.', 'warning');
});
</script>
</body>
</html>
